---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all blog posts and sort by date
const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => 
  b.data.pubDate.getTime() - a.data.pubDate.getTime()
);
---

<BaseLayout title="My Blog - Home" description="Welcome to my personal blog">
  <section class="posts">
    <div class="post-grid">
      {sortedPosts.map(post => (
        <article class="post-card">
          <div class="post-content">
			<p class="post-meta">
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric'
                })}
              </time>
            </p>
            <h3>
              <a href={`/posts/${post.slug}`}>{post.data.title}</a>
            </h3>
            
            <p>{post.data.description}</p>
            {post.data.tags && (
              <div class="tags">
                {post.data.tags.map(tag => (
                  <span class="tag">{tag}</span>
                ))}
              </div>
            )}
          </div>
        </article>
      ))}
    </div>
  </section>
</BaseLayout>

<style>
  .posts h2 {
    font-size: 1.5rem;
    margin-bottom: 2rem;
  }
  
  .post-grid {
    display: flex;
	flex-direction: column;
	gap: 1.75rem;
  }
  
  .post-card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }
  
  .post-card h3 {
    margin: 0 0 0.3rem 0;
	font-size: 1.5rem;
  }
  
  .post-card h3 a {
    color: #000000;
    text-decoration: none;
  }
  
  .post-card h3 a:hover {
    color: #000000;
	text-decoration: underline;
  }
  
  .post-meta {
    color:#a6a09b;
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
  }
  
  .tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-top: 0.5rem;
  }
  
  .tag {
    padding: 0.15rem 0.60rem;
    border-radius: 20px;
    font-size: 0.85rem;
    border: 1px solid #a6a09b;
  }
</style>